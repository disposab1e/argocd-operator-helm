#!/usr/bin/env bash
set -e

if [ -z "${OLM_VERSION}" ]; then
    OLM=${OLM_VERSION}
else
    OLM=0.13.0
fi

# Operator Lifecycle Manager
echo "======================================================"
echo "Installing Operator Lifecycle Manager ${OLM}"
echo "======================================================"
curl -sL https://github.com/operator-framework/operator-lifecycle-manager/releases/download/${OLM}/install.sh | bash -s ${OLM}

# Delete "operatorhubio-catalog" cause we provide our own catalogue
echo "======================================================"
echo "Delete Community Catalogue from operatohub.io"
echo "======================================================"
kubectl delete catalogsource operatorhubio-catalog -n olm
